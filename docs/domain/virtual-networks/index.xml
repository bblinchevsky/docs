<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>– Virtual Networks</title><link>/docs/domain/virtual-networks/</link><description>Recent content in Virtual Networks on</description><generator>Hugo -- gohugo.io</generator><atom:link href="/docs/domain/virtual-networks/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Access Policy</title><link>/docs/domain/virtual-networks/access-policy/</link><pubDate>Wed, 28 Dec 2022 00:00:00 +0000</pubDate><guid>/docs/domain/virtual-networks/access-policy/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>An access policy is a list of rules that each allow, reject, or drop traffic at the VPN level.&lt;/p>
&lt;/div>
&lt;p>If no rules are defined, traffic will not pass through the &lt;a href="/docs/domain/virtual-networks/">virtual network&lt;/a>.&lt;/p>
&lt;p>&lt;strong>A rule can match traffic based on the following fields:&lt;/strong>&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Field Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;th>Action&lt;/th>
&lt;td>Whether to ALLOW, DROP, or REJECT the traffic.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Protocol&lt;/th>
&lt;td>You can choose ANY, UDP, ICMP, or TCP.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Source&lt;/th>
&lt;td>The source of the traffic. You can select a &lt;a href="/docs/domain/virtual-networks/network-objects/">network object&lt;/a>, a &lt;a href="/docs/domain/virtual-networks/network-groups/">network group&lt;/a>, or provide a CIDR.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Destination&lt;/th>
&lt;td>The destination of the traffic. You can select a &lt;a href="/docs/domain/virtual-networks/network-objects/">network object&lt;/a>, a &lt;a href="/docs/domain/virtual-networks/network-groups/">network group&lt;/a>, or provide a CIDR.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Line Number&lt;/th>
&lt;td>Rules are evaluated starting with the lowest numbered rule. Once a rule matches, later rules are ignored even if they might also match the traffic. &lt;strong>(confirm w/ Steven)&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Port Range&lt;/th>
&lt;td>For TCP and UDP traffic, you can specify a port (e.g., 80) or a range (e.g., 8000-9000).&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;img src="access-policy.png" alt="img">&lt;/p>
&lt;p>&lt;strong>Note that &lt;em>all specified&lt;/em> fields must be matched for the rule to match. (confirm w steven).&lt;/strong>&lt;/p></description></item><item><title>Docs: Network Groups</title><link>/docs/domain/virtual-networks/network-groups/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/domain/virtual-networks/network-groups/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>A network group is a list of &lt;a href="/docs/domain/virtual-networks/network-objects/">network objects&lt;/a> that allows for easier rule management.&lt;/p>
&lt;/div>
&lt;p>A network group requires a name to be set. This will be used to reference the group in &lt;a href="/docs/domain/virtual-networks/access-policy/">access policy&lt;/a> rules.&lt;/p>
&lt;p>&lt;img src="network-groups2.png" alt="img">&lt;/p>
&lt;p>Navigating into a network group allows management of the group’s member objects.&lt;/p>
&lt;p>&lt;img src="member-network-objects.png" alt="img">&lt;/p></description></item><item><title>Docs: Network Objects</title><link>/docs/domain/virtual-networks/network-objects/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/domain/virtual-networks/network-objects/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>A network object allows naming a CIDR inside a VPN for easier rule management.&lt;/p>
&lt;/div>
&lt;p>A network object requires the following fields:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Field Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;td>The label to use when referencing this object.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>CIDR&lt;/th>
&lt;td>Specifically an IPv4 CIDR.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;img src="network-objects.png" alt="img">&lt;/p>
&lt;p>Multiple network objects may be clustered into a &lt;a href="/docs/domain/virtual-networks/network-groups/">network group&lt;/a>.&lt;/p></description></item><item><title>Docs: Routes</title><link>/docs/domain/virtual-networks/routes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/domain/virtual-networks/routes/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>Routes configured under &lt;a href="/docs/domain/">Domains&lt;/a> determine to which &lt;a href="/docs/nodes/">node&lt;/a> or &lt;a href="/docs/clusters/">cluster&lt;/a> the &lt;a href="/docs/domain/virtual-networks/">Trustgrid virtual network&lt;/a> should route traffic for a specific subnet.&lt;/p>
&lt;/div>
&lt;h2 id="route-configuration">Route Configuration&lt;/h2>
&lt;ol>
&lt;li>Login to the portal and select &lt;a href="/docs/domain/">&lt;code>domains&lt;/code>&lt;/a>.&lt;/li>
&lt;li>Click the link to the desired domain under the &amp;ldquo;Name&amp;rdquo; column.&lt;/li>
&lt;li>Scroll down to the &lt;a href="/docs/domain/virtual-networks/">&amp;ldquo;Virtual Networks&amp;rdquo;&lt;/a> section and select the &lt;code>Routes&lt;/code> tab.&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="routes-list.png" alt="img">&lt;/p>
&lt;p>A Route has Three Required Fields:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Field Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;th>Destination&lt;/th>
&lt;td>This will be the name of the &lt;a href="/docs/nodes/">node&lt;/a> or &lt;a href="/docs/clusters/">cluster&lt;/a> that traffic will be routed to. This list is auto-populated based on the nodes and clusters in the selected &lt;a href="/docs/domain/">domain&lt;/a>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Destination CIDR&lt;/th>
&lt;td>This is the CIDR notation of the &lt;a href="/docs/domain/virtual-networks/">virtual network&lt;/a> that should be routed to the above destination &lt;a href="/docs/nodes/">node&lt;/a> or &lt;a href="/docs/clusters/">cluster&lt;/a>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;th>Metric&lt;/th>
&lt;td>If there are multiple routes for the same &lt;a href="/docs/domain/virtual-networks/">virtual network&lt;/a> the metric will determine which route will be used. The lowest number is the highest priority. See the &amp;ldquo;Automatic Failover&amp;rdquo; text below.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="route-failover">Route Failover &lt;/h2>
&lt;p>Route failover allows a subnet to be routed to an alternate &lt;a href="/docs/nodes/">node&lt;/a> or &lt;a href="/docs/clusters/">cluster&lt;/a> in the event of a failure.  This can be automatic or performed manually.&lt;/p>
&lt;h3 id="prerequisites">Prerequisites &lt;/h3>
&lt;p>In either configuration, the &lt;a href="/docs/domain/virtual-networks/">virtual network&lt;/a> settings under VPN settings for the primary and backup destination &lt;a href="/docs/nodes/">nodes&lt;/a>/&lt;a href="/docs/clusters/">clusters&lt;/a> must match. Including:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Network Virtual Route&lt;/p>
&lt;p>&lt;img src="virtual-network-route.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Network Group under Outside NAT Table&lt;/p>
&lt;p>&lt;img src="outside-nat-table.png" alt="img">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Virtual CIDR under Inside NAT Table&lt;/p>
&lt;p>&lt;img src="inside-nat-table.png" alt="img">&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="automatic-failover">Automatic Failover&lt;/h3>
&lt;p>To have the route failover without manual intervention you must define two routes for the same subnet (Destination CIDR) with different metrics.  The lowest numerical metric will take precedence unless the destination &lt;a href="/docs/nodes/">node&lt;/a> or &lt;a href="/docs/clusters/">cluster&lt;/a> is offline.&lt;/p>
&lt;p>In the below example configuration we want traffic for the 10.20.0.0/24 network to the &lt;code>edge&lt;/code> &lt;a href="/docs/clusters/">cluster&lt;/a> first, and failover to the &lt;code>edge-dr&lt;/code> &lt;a href="/docs/clusters/">cluster&lt;/a>.&lt;/p>
&lt;p>&lt;img src="automatic-failover.png" alt="img">&lt;/p>
&lt;h3 id="preventing-automated-failback-or-forcing-a-failover">Preventing Automated Failback or Forcing a Failover&lt;/h3>
&lt;p>As mentioned above if multiple routes are configured traffic will route to destination with the lowest metric number. So if the primary destination fails but then comes back online traffic will be routed back automatically.&lt;/p>
&lt;p>However, there are some circumstances where this is not desirable. For example, if the primary site is unstable you may wish to keep traffic at the backup site until the primary is stabilized. Alternately, you may wish to preemptively reroute traffic to the backup site in advance of planned maintenance at the primary site.&lt;/p>
&lt;p>To preemptively reroute traffic to the backup site, update the backup route to have a lower metric than the primary route.&lt;/p>
&lt;h3 id="manual-failover">Manual Failover&lt;/h3>
&lt;p>In some circumstances, it may be preferable for failover to only occur with manual intervention. In this situation, you will have a single route under the &lt;a href="/docs/domain/">domain&lt;/a>.  To initiate a failover you&amp;rsquo;ll need to update the destination &lt;a href="/docs/clusters/">cluster&lt;/a>/&lt;a href="/docs/nodes/">node&lt;/a>.&lt;/p>
&lt;ol>
&lt;li>Login to the Portal and select your domain.&lt;/li>
&lt;li>Click the link to the desired &lt;a href="/docs/domain/">domain&lt;/a> under the &amp;ldquo;Name&amp;rdquo; column.&lt;/li>
&lt;li>Scroll down to the &lt;a href="/docs/domain/virtual-networks/">&amp;ldquo;Virtual Networks&amp;rdquo;&lt;/a> section and select the &amp;ldquo;Routes&amp;rdquo; tab.&lt;/li>
&lt;li>Find the route you wish to failover.&lt;/li>
&lt;li>Update the destination device. (e.g. in the below you would switch from edge to edge-dr).
(add screenshot of instructions NEEDS TO BE FIXED)&lt;/li>
&lt;li>Click save.&lt;/li>
&lt;/ol></description></item></channel></rss>